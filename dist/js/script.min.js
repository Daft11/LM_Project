window.onload=()=>{const e=document.getElementById("filter_btn");document.getElementById("slideBar");choiceBox.linkButton(),e.addEventListener("click",filterObj.openFilters),filterObj.getMaterialsIds().forEach((e,t)=>{(e=document.getElementById(e)).addEventListener("click",(function(e){let r=filterObj.getSortCovers();!0===e.target.checked?r[t].forEach(e=>document.getElementById(e).checked=!0):r[t].forEach(e=>document.getElementById(e).checked=!1)}))})};class Filter{itemsArray;constructor(){fetch("http://localhost:3000/getItemsArray").then(e=>e.json()).then(e=>{this.itemsArray=e,console.log(this.itemsArray)})}getMaterialsIds=()=>{const e=[];return this.itemsArray.forEach(t=>{e.includes(t.idMaterial)||e.push(t.idMaterial)}),e};getCoversIds=()=>{const e=[];return this.itemsArray.forEach(t=>{e.includes(t.idCover)||e.push(t.idCover)}),e};getSortCovers=()=>{const e=this.getMaterialsIds(),t=[];return e.forEach(e=>{const r=[];this.itemsArray.forEach(t=>{t.idMaterial===e&&(r.includes(t.idCover)||r.push(t.idCover))}),t.push(r)}),t};openFilters=()=>{document.getElementById("filter_submit-btn").addEventListener("click",this.submitFilters),document.getElementById("filter_clear-btn").addEventListener("click",this.clearFilters),document.addEventListener("click",e=>{document.getElementById("facade__filter").contains(e.target)||this.sidebarHide()}),"510px"==slideBar.style.height?this.sidebarHide():this.sidebarShow()};submitFilters=()=>{const e=this.getMaterialsIds(),t=this.getCoversIds();this.reloadFilter(),this.filterCheckLoop(e),this.filterCheckLoop(t),this.sidebarHide(),concat()};reloadFilter=()=>{this.itemsArray.forEach(e=>document.getElementById(e.idFacade).style.display="flex")};sidebarHide=()=>{slideBar.style.height="50px",filter_btn.className="filter__btn"};sidebarShow=()=>{slideBar.style.height="510px",filter_btn.className+="_after"};clearFilters=()=>{this.itemsArray.forEach(e=>{document.getElementById(e.idMaterial).checked=!1,document.getElementById(e.idCover).checked=!1}),this.submitFilters()};filterCheckLoop=e=>{let t,r=[];if(e.forEach(e=>{t=document.getElementById(e),!0===t.checked&&r.push(e)}),r.length>0)return r=e.filter(e=>r.includes(e)),this.filterAction(r)};filterAction=e=>{const t=[];this.itemsArray.filter(t=>!e.includes(t.idMaterial)&&!e.includes(t.idCover)).forEach(e=>t.push(e.idFacade));for(var r=0;r<t.length;r++)document.getElementById(t[r]).style.display="none";return t}}const filterObj=new Filter;concat=()=>{const e=filterObj.getMaterialsIds(),t=filterObj.getCoversIds();let r=[];r=r.concat(filterObj.filterCheckLoop(e)),r=r.concat(filterObj.filterCheckLoop(t)),r=r.reduce((e,t)=>e.includes(t)||null==t?e:[...e,t],[]),document.getElementById("filter_info").innerHTML="Показано "+(filterObj.itemsArray.length-r.length)+" из "+filterObj.itemsArray.length};const choiceBox={currentItemId:null,currentAreaHeight:null,correctAreaHeight:"100px",currentName:null,currentImgSrc:null,linkButton(){const e=document.getElementsByClassName("item__choice-button");for(let t of e)t.addEventListener("click",choiceBox.action)},action(e){choiceBox.showArea(),choiceBox.currentItemId=e.target.parentElement.id,choiceBox.currentName=e.target.parentElement.getElementsByClassName("item__name")[0].innerHTML,choiceBox.currentImgSrc=e.target.parentElement.getElementsByClassName("item__img")[0].src,choiceBox.currentAreaHeight=document.getElementById("select__area").style.height,document.getElementById("selected__facade__name").innerHTML=choiceBox.currentName,document.getElementById("selected__facade__img").src=choiceBox.currentImgSrc},showArea(){choiceBox.currentAreaHeight!=choiceBox.correctAreaHeight&&(document.getElementById("select__area").style.height=choiceBox.correctAreaHeight)}};function hide(){document.getElementById("select__area").style.height=0,choiceBox.currentAreaHeight=document.getElementById("select__area").style.height}