window.onload=()=>{const e=document.getElementById("filter_btn");document.getElementById("slideBar");choiceBox.linkButton(),e.addEventListener("click",filterObj.openFilters)};class Filter{itemsArray;constructor(){fetch("http://localhost:3000/getItemsArray").then(e=>e.json()).then(e=>{this.itemsArray=e,this.setOfChecked()})}setOfChecked=()=>{filterObj.getMaterialsIds().forEach((e,t)=>{(e=document.getElementById(e)).addEventListener("click",(function(e){let i=filterObj.getSortCovers();!0===e.target.checked?i[t].forEach(e=>document.getElementById(e).checked=!0):i[t].forEach(e=>document.getElementById(e).checked=!1)}))})};getMaterialsIds=()=>{const e=[];return this.itemsArray.forEach(t=>{e.includes(t.idMaterial)||e.push(t.idMaterial)}),e};getCoversIds=()=>{const e=[];return this.itemsArray.forEach(t=>{e.includes(t.idCover)||e.push(t.idCover)}),e};getSortCovers=()=>{const e=this.getMaterialsIds(),t=[];return e.forEach(e=>{const i=[];this.itemsArray.forEach(t=>{t.idMaterial===e&&(i.includes(t.idCover)||i.push(t.idCover))}),t.push(i)}),t};openFilters=()=>{document.getElementById("filter_submit-btn").addEventListener("click",this.submitFilters),document.getElementById("filter_clear-btn").addEventListener("click",this.clearFilters),document.addEventListener("click",e=>{document.getElementById("facade__filter").contains(e.target)||this.sidebarHide()}),"510px"==slideBar.style.height?this.sidebarHide():this.sidebarShow()};submitFilters=()=>{const e=this.getMaterialsIds(),t=this.getCoversIds();this.reloadFilter(),this.filterCheckLoop(e),this.filterCheckLoop(t),this.sidebarHide(),this.showResult()};reloadFilter=()=>{this.itemsArray.forEach(e=>document.getElementById(e.idFacade).style.display="flex")};sidebarHide=()=>{slideBar.style.height="50px",filter_btn.className="filter__btn"};sidebarShow=()=>{slideBar.style.height="510px",filter_btn.className+="_after"};clearFilters=()=>{this.itemsArray.forEach(e=>{document.getElementById(e.idMaterial).checked=!1,document.getElementById(e.idCover).checked=!1}),this.submitFilters()};filterCheckLoop=e=>{let t,i=[];if(e.forEach(e=>{t=document.getElementById(e),!0===t.checked&&i.push(e)}),i.length>0)return i=e.filter(e=>i.includes(e)),this.filterAction(i)};filterAction=e=>{const t=[];this.itemsArray.filter(t=>!e.includes(t.idMaterial)&&!e.includes(t.idCover)).forEach(e=>t.push(e.idFacade));for(var i=0;i<t.length;i++)document.getElementById(t[i]).style.display="none";return t};showResult=()=>{const e=document.getElementById("filter_info"),t=this.getMaterialsIds(),i=this.getCoversIds();let s=[];s=s.concat(this.filterCheckLoop(t)).concat(this.filterCheckLoop(i)),s=s.reduce((e,t)=>e.includes(t)||null==t?e:[...e,t],[]),s.length>0?(e.innerHTML="Показано "+(this.itemsArray.length-s.length)+" из "+this.itemsArray.length+'<a class="filter__info__clear-btn" id="filter__info__clear-btn"></a>',document.getElementById("filter__info__clear-btn").addEventListener("click",this.clearFilters)):e.innerHTML=""}}const filterObj=new Filter,choiceBox={area:document.getElementById("select__area"),areaButton:document.getElementById("next__btn"),currentItemId:null,currentAreaHeight:null,correctAreaHeight:"100px",currentName:null,currentImgSrc:null,linkButton(){this.areaButton.addEventListener("click",shapeBox.showBox);const e=document.getElementsByClassName("item__choice-button");for(let t of e)t.addEventListener("click",this.action)},action(e){choiceBox.showArea(),choiceBox.currentItemId=e.target.parentElement.id,choiceBox.currentName=e.target.parentElement.getElementsByClassName("item__name")[0].innerHTML,choiceBox.currentImgSrc=e.target.parentElement.getElementsByClassName("item__img")[0].src,choiceBox.currentAreaHeight=document.getElementById("select__area").style.height,document.getElementById("selected__facade__name").innerHTML=choiceBox.currentName,document.getElementById("selected__facade__img").src=choiceBox.currentImgSrc,console.log(choiceBox.currentItemId)},showArea(){this.currentAreaHeight!=this.correctAreaHeight&&(this.area.style.height=this.correctAreaHeight)}};function hide(){document.getElementById("select__area").style.height=0,choiceBox.currentAreaHeight=document.getElementById("select__area").style.height}const shapeBox={shape:"line",firstSize:0,secondSize:0,thirdSize:0,shapeCardsIdArray:["geometry-line-shaped","geometry-l-shaped-left","geometry-l-shaped-right","geometry-u-shaped"],sizeInputIdArray:["size-first","size-second","size-third"],sizeWall:document.getElementsByClassName("enter__size-display")[0].firstElementChild,sizeWallDefaultClassName:"enter__size-wall",inputVisibilitySet:{line:[1,.2,.2,!1,!0,!0],lShapedLeft:[1,1,.2,!1,!1,!0],lShapedRight:[1,1,.2,!1,!1,!0],uShaped:[1,1,1,!1,!1,!1]},switchShape(){this.shapeCardsIdArray.forEach(e=>{document.getElementById(e).addEventListener("click",shapeBox.getShape.bind(shapeBox))})},getShape(){this.shapeCardsIdArray.forEach(e=>{document.getElementById(e).checked&&(this.shape=document.getElementById(e).value,this.sizeWall.className=this.sizeWallDefaultClassName,this.sizeWall.className+=e.slice(8),this.inputShowSwitch(this.shape))})},inputShowSwitch(e){if("line"===e){for(var t=0;t<this.sizeInputIdArray.length;t++)document.getElementById(this.sizeInputIdArray[t]).style.opacity=this.inputVisibilitySet.line[t],document.getElementById(this.sizeInputIdArray[t]).firstElementChild.disabled=this.inputVisibilitySet.line[t+3];return this.inputFocus(),this.flashingWall(e)}if("l-shaped-left"===e){for(t=0;t<this.sizeInputIdArray.length;t++)document.getElementById(this.sizeInputIdArray[t]).style.opacity=this.inputVisibilitySet.lShapedLeft[t],document.getElementById(this.sizeInputIdArray[t]).firstElementChild.disabled=this.inputVisibilitySet.lShapedLeft[t+3];return this.inputFocus(e),this.flashingWall(e)}if("l-shaped-right"===e){for(t=0;t<this.sizeInputIdArray.length;t++)document.getElementById(this.sizeInputIdArray[t]).style.opacity=this.inputVisibilitySet.lShapedRight[t],document.getElementById(this.sizeInputIdArray[t]).firstElementChild.disabled=this.inputVisibilitySet.lShapedRight[t+3];return this.inputFocus(e),this.flashingWall(e)}if("u-shaped"===e){for(t=0;t<this.sizeInputIdArray.length;t++)document.getElementById(this.sizeInputIdArray[t]).style.opacity=this.inputVisibilitySet.uShaped[t],document.getElementById(this.sizeInputIdArray[t]).firstElementChild.disabled=this.inputVisibilitySet.uShaped[t+3];return this.inputFocus(e),this.flashingWall(e)}},showBox(){document.getElementById("shape-box").style.minHeight="600px",document.getElementById("shape-box").style.height="100vh",shapeBox.getShape(),shapeBox.switchShape()},inputFocus(){const e=document.getElementById(this.sizeInputIdArray[0]).firstElementChild;e.focus(),e.select()},flashingWall(e){"l-shaped-left"===e?this.sizeWall.className+=" anim-left-border":"line"===e||"l-shaped-right"===e?this.sizeWall.className+=" anim-top-border":"u-shaped"===e&&(this.sizeWall.className+=" anim-left-border")}};function onlyNumberKey(e){var t=e.which?e.which:e.keyCode;return!(t>31&&(t<48||t>57))}function checkLength(e,t){if(t.value.length<=e)return!0;var i=t.value;i=i.substring(0,i.length-1),t.value=i}const summaryProgress={};